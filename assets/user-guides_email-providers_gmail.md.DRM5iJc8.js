import{_ as o,c as t,o as i,ag as a}from"./chunks/framework.S-Qvb3wi.js";const u=JSON.parse('{"title":"Connecting Gmail (Personal Accounts)","description":"","frontmatter":{},"headers":[],"relativePath":"user-guides/email-providers/gmail.md","filePath":"user-guides/email-providers/gmail.md"}'),s={name:"user-guides/email-providers/gmail.md"};function n(r,e,l,c,h,p){return i(),t("div",null,e[0]||(e[0]=[a(`<h1 id="connecting-gmail-personal-accounts" tabindex="-1">Connecting Gmail (Personal Accounts) <a class="header-anchor" href="#connecting-gmail-personal-accounts" aria-label="Permalink to &quot;Connecting Gmail (Personal Accounts)&quot;">​</a></h1><p>This guide explains how to connect a personal Gmail account (@gmail.com) to Open Archiver for email archiving.</p><div class="info custom-block"><p class="custom-block-title">Google Workspace vs Personal Gmail</p><p>This guide is for <strong>personal Gmail accounts</strong>. If you&#39;re archiving emails from a Google Workspace organization, see <a href="./google-workspace.html">Google Workspace</a> instead, which uses service account authentication for organization-wide access.</p></div><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to &quot;Overview&quot;">​</a></h2><p>Open Archiver uses OAuth 2.0 to securely connect to your Gmail account. The connection process involves:</p><ol><li>Setting up a Google Cloud project with OAuth credentials</li><li>Configuring Open Archiver with your OAuth client ID and secret</li><li>Authorizing the connection through Google&#39;s sign-in flow</li></ol><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><ul><li>A Google account</li><li>Access to <a href="https://console.cloud.google.com/" target="_blank" rel="noreferrer">Google Cloud Console</a></li><li>Open Archiver deployed and running</li></ul><h2 id="step-1-create-a-google-cloud-project" tabindex="-1">Step 1: Create a Google Cloud Project <a class="header-anchor" href="#step-1-create-a-google-cloud-project" aria-label="Permalink to &quot;Step 1: Create a Google Cloud Project&quot;">​</a></h2><ol><li>Go to the <a href="https://console.cloud.google.com/" target="_blank" rel="noreferrer">Google Cloud Console</a></li><li>Click <strong>Select a project</strong> → <strong>New Project</strong></li><li>Enter a project name (e.g., &quot;Open Archiver&quot;) and click <strong>Create</strong></li><li>Make sure your new project is selected</li></ol><h2 id="step-2-enable-the-gmail-api" tabindex="-1">Step 2: Enable the Gmail API <a class="header-anchor" href="#step-2-enable-the-gmail-api" aria-label="Permalink to &quot;Step 2: Enable the Gmail API&quot;">​</a></h2><ol><li>In the Google Cloud Console, go to <strong>APIs &amp; Services</strong> → <strong>Library</strong></li><li>Search for &quot;Gmail API&quot;</li><li>Click on <strong>Gmail API</strong> and then click <strong>Enable</strong></li></ol><h2 id="step-3-configure-oauth-consent-screen" tabindex="-1">Step 3: Configure OAuth Consent Screen <a class="header-anchor" href="#step-3-configure-oauth-consent-screen" aria-label="Permalink to &quot;Step 3: Configure OAuth Consent Screen&quot;">​</a></h2><ol><li>Go to <strong>APIs &amp; Services</strong> → <strong>OAuth consent screen</strong></li><li>Select <strong>External</strong> as the user type (unless you have a Google Workspace organization)</li><li>Click <strong>Create</strong></li><li>Fill in the required fields: <ul><li><strong>App name</strong>: Open Archiver (or your preferred name)</li><li><strong>User support email</strong>: Your email address</li><li><strong>Developer contact information</strong>: Your email address</li></ul></li><li>Click <strong>Save and Continue</strong></li></ol><h3 id="add-required-scopes" tabindex="-1">Add Required Scopes <a class="header-anchor" href="#add-required-scopes" aria-label="Permalink to &quot;Add Required Scopes&quot;">​</a></h3><ol><li>Click <strong>Add or Remove Scopes</strong></li><li>Add the following scopes: <ul><li><code>https://www.googleapis.com/auth/gmail.readonly</code> - View your email messages and settings</li><li><code>https://www.googleapis.com/auth/userinfo.email</code> - See your primary Google Account email address</li><li><code>https://www.googleapis.com/auth/userinfo.profile</code> - See your personal info</li></ul></li><li>Click <strong>Update</strong> and then <strong>Save and Continue</strong></li></ol><h3 id="add-test-users" tabindex="-1">Add Test Users <a class="header-anchor" href="#add-test-users" aria-label="Permalink to &quot;Add Test Users&quot;">​</a></h3><p>While your app is in &quot;Testing&quot; status (not published), you need to add test users:</p><ol><li>Click <strong>Add Users</strong></li><li>Enter the Gmail address(es) you want to connect to Open Archiver</li><li>Click <strong>Add</strong> and then <strong>Save and Continue</strong></li></ol><div class="tip custom-block"><p class="custom-block-title">Publishing Your App</p><p>You can keep your app in &quot;Testing&quot; mode for personal use with up to 100 test users. If you need to connect more accounts, you&#39;ll need to publish the app and go through Google&#39;s verification process.</p></div><h2 id="step-4-create-oauth-client-credentials" tabindex="-1">Step 4: Create OAuth Client Credentials <a class="header-anchor" href="#step-4-create-oauth-client-credentials" aria-label="Permalink to &quot;Step 4: Create OAuth Client Credentials&quot;">​</a></h2><ol><li>Go to <strong>APIs &amp; Services</strong> → <strong>Credentials</strong></li><li>Click <strong>Create Credentials</strong> → <strong>OAuth client ID</strong></li><li>Select <strong>Web application</strong> as the application type</li><li>Enter a name (e.g., &quot;Open Archiver Web Client&quot;)</li><li>Under <strong>Authorized redirect URIs</strong>, add:<div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http://localhost:4000/api/v1/auth/gmail/callback</span></span></code></pre></div></li><li>Click <strong>Create</strong></li><li>Copy the <strong>Client ID</strong> and <strong>Client Secret</strong> - you&#39;ll need these for Open Archiver</li></ol><div class="warning custom-block"><p class="custom-block-title">Important</p><p>The redirect URI uses <code>localhost</code> even though your server may be running elsewhere. This is intentional - the authorization flow uses a manual code exchange that doesn&#39;t require the redirect to actually reach your server.</p></div><h2 id="step-5-configure-open-archiver" tabindex="-1">Step 5: Configure Open Archiver <a class="header-anchor" href="#step-5-configure-open-archiver" aria-label="Permalink to &quot;Step 5: Configure Open Archiver&quot;">​</a></h2><p>Add the following environment variables to your Open Archiver deployment:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GOOGLE_OAUTH_CLIENT_ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-client-id.apps.googleusercontent.com</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GOOGLE_OAUTH_CLIENT_SECRET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">your-client-secret</span></span></code></pre></div><p>If using Docker Compose, add these to your <code>.env</code> file and restart the containers:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> down</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> compose</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span></span></code></pre></div><h2 id="step-6-connect-your-gmail-account" tabindex="-1">Step 6: Connect Your Gmail Account <a class="header-anchor" href="#step-6-connect-your-gmail-account" aria-label="Permalink to &quot;Step 6: Connect Your Gmail Account&quot;">​</a></h2><ol><li>Log in to Open Archiver</li><li>Go to <strong>Dashboard</strong> → <strong>Ingestions</strong></li><li>Click <strong>Add Source</strong></li><li>Select <strong>Gmail</strong> as the provider</li><li>Enter a name for this ingestion source</li><li>Click <strong>Create</strong></li></ol><p>A dialog will appear with authorization instructions:</p><h3 id="authorization-steps" tabindex="-1">Authorization Steps <a class="header-anchor" href="#authorization-steps" aria-label="Permalink to &quot;Authorization Steps&quot;">​</a></h3><ol><li><p><strong>Click &quot;Sign in with Google&quot;</strong> - This opens Google&#39;s authorization page in a new tab</p></li><li><p><strong>Authorize the application</strong> - Sign in with your Gmail account and grant the requested permissions</p></li><li><p><strong>Copy the authorization code</strong> - After authorizing, you&#39;ll be redirected to a page that won&#39;t load (this is expected). Look at your browser&#39;s address bar - it will show a URL like:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>http://localhost:4000/api/v1/auth/gmail/callback?code=4/0AQSTgQGx...&amp;scope=...</span></span></code></pre></div><p>Copy the value after <code>code=</code> and before <code>&amp;scope=</code></p></li><li><p><strong>Paste the code</strong> - Return to Open Archiver and paste the code into the input field</p></li><li><p><strong>Click &quot;Connect Account&quot;</strong> - Open Archiver will exchange the code for access tokens and begin archiving</p></li></ol><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="no-refresh-token-received" tabindex="-1">&quot;No refresh token received&quot; <a class="header-anchor" href="#no-refresh-token-received" aria-label="Permalink to &quot;&quot;No refresh token received&quot;&quot;">​</a></h3><p>This error occurs when Google doesn&#39;t provide a refresh token. To fix this:</p><ol><li>Go to <a href="https://myaccount.google.com/permissions" target="_blank" rel="noreferrer">Google Account Permissions</a></li><li>Find &quot;Open Archiver&quot; (or your app name) and click <strong>Remove Access</strong></li><li>Try connecting again in Open Archiver</li></ol><h3 id="invalid-or-expired-code" tabindex="-1">&quot;Invalid or expired code&quot; <a class="header-anchor" href="#invalid-or-expired-code" aria-label="Permalink to &quot;&quot;Invalid or expired code&quot;&quot;">​</a></h3><p>Authorization codes expire quickly. Make sure to:</p><ul><li>Complete the authorization process without delays</li><li>Copy the entire code value (it can be quite long)</li><li>Paste it immediately into Open Archiver</li></ul><h3 id="access-blocked-app-not-verified" tabindex="-1">&quot;Access blocked: App not verified&quot; <a class="header-anchor" href="#access-blocked-app-not-verified" aria-label="Permalink to &quot;&quot;Access blocked: App not verified&quot;&quot;">​</a></h3><p>If you see this warning:</p><ol><li>Click <strong>Advanced</strong> → <strong>Go to [App Name] (unsafe)</strong></li><li>Continue with the authorization</li></ol><p>This warning appears for apps in &quot;Testing&quot; mode that haven&#39;t been verified by Google.</p><h2 id="what-gets-archived" tabindex="-1">What Gets Archived <a class="header-anchor" href="#what-gets-archived" aria-label="Permalink to &quot;What Gets Archived&quot;">​</a></h2><p>Once connected, Open Archiver will:</p><ol><li>Perform an initial import of all emails in your Gmail account</li><li>Continue syncing new emails as they arrive</li><li>Index email content and attachments for full-text search</li></ol><p>The connection uses read-only access - Open Archiver cannot modify or delete your emails.</p><h2 id="revoking-access" tabindex="-1">Revoking Access <a class="header-anchor" href="#revoking-access" aria-label="Permalink to &quot;Revoking Access&quot;">​</a></h2><p>To disconnect your Gmail account:</p><ol><li>In Open Archiver, delete the ingestion source</li><li>Optionally, revoke access at <a href="https://myaccount.google.com/permissions" target="_blank" rel="noreferrer">Google Account Permissions</a></li></ol>`,51)]))}const g=o(s,[["render",n]]);export{u as __pageData,g as default};
