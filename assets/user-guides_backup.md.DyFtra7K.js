import{_ as a,c as i,o as t,ag as e}from"./chunks/framework.S-Qvb3wi.js";const c=JSON.parse('{"title":"Backup and Restore","description":"","frontmatter":{},"headers":[],"relativePath":"user-guides/backup.md","filePath":"user-guides/backup.md"}'),n={name:"user-guides/backup.md"};function l(p,s,h,r,k,o){return t(),i("div",null,s[0]||(s[0]=[e(`<h1 id="backup-and-restore" tabindex="-1">Backup and Restore <a class="header-anchor" href="#backup-and-restore" aria-label="Permalink to &quot;Backup and Restore&quot;">​</a></h1><p>This guide outlines a backup strategy for Open Archiver to protect your archived emails and configuration.</p><h2 id="what-to-backup" tabindex="-1">What to Backup <a class="header-anchor" href="#what-to-backup" aria-label="Permalink to &quot;What to Backup&quot;">​</a></h2><p>Open Archiver stores data across multiple components:</p><table tabindex="0"><thead><tr><th>Component</th><th>Contains</th><th>Backup Required?</th></tr></thead><tbody><tr><td>Storage folder</td><td>Raw .eml files and attachments</td><td><strong>Yes</strong> - Primary data</td></tr><tr><td>PostgreSQL</td><td>Metadata, config, users, audit logs</td><td><strong>Yes</strong> - Critical</td></tr><tr><td>Meilisearch</td><td>Full-text search index</td><td>Optional - Can rebuild</td></tr><tr><td>Redis/Valkey</td><td>Job queues</td><td>No - Ephemeral</td></tr></tbody></table><h3 id="storage-folder-critical" tabindex="-1">Storage Folder (Critical) <a class="header-anchor" href="#storage-folder-critical" aria-label="Permalink to &quot;Storage Folder (Critical)&quot;">​</a></h3><p>The storage folder contains all raw email files (.eml) and attachments. This is your primary data and cannot be recreated.</p><p><strong>Location depends on your <code>STORAGE_TYPE</code>:</strong></p><ul><li><strong>Local storage</strong>: <code>{STORAGE_LOCAL_ROOT_PATH}/open-archiver/</code></li><li><strong>S3 storage</strong>: <code>{STORAGE_S3_BUCKET}/open-archiver/</code></li></ul><p><strong>Folder structure:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>open-archiver/</span></span>
<span class="line"><span>├── {SourceName}-{SourceId}/</span></span>
<span class="line"><span>│   ├── emails/</span></span>
<span class="line"><span>│   │   ├── INBOX/</span></span>
<span class="line"><span>│   │   │   ├── msg_12345.eml</span></span>
<span class="line"><span>│   │   │   └── msg_12346.eml</span></span>
<span class="line"><span>│   │   └── Sent/</span></span>
<span class="line"><span>│   │       └── msg_67890.eml</span></span>
<span class="line"><span>│   └── attachments/</span></span>
<span class="line"><span>│       ├── a1b2c3d-document.pdf</span></span>
<span class="line"><span>│       └── e4f5g6h-image.png</span></span>
<span class="line"><span>└── {AnotherSource}-{SourceId}/</span></span>
<span class="line"><span>    └── ...</span></span></code></pre></div><h3 id="postgresql-database-critical" tabindex="-1">PostgreSQL Database (Critical) <a class="header-anchor" href="#postgresql-database-critical" aria-label="Permalink to &quot;PostgreSQL Database (Critical)&quot;">​</a></h3><p>The database stores:</p><ul><li>Email metadata (sender, recipients, dates, subjects, hashes)</li><li>Ingestion source configurations and credentials</li><li>User accounts and roles</li><li>API keys</li><li>Attachment records</li><li>Audit logs</li></ul><h3 id="meilisearch-index-optional" tabindex="-1">Meilisearch Index (Optional) <a class="header-anchor" href="#meilisearch-index-optional" aria-label="Permalink to &quot;Meilisearch Index (Optional)&quot;">​</a></h3><p>The search index can be rebuilt from the database and storage files by triggering a re-index. Backing it up speeds up recovery but is not essential.</p><h2 id="backup-commands" tabindex="-1">Backup Commands <a class="header-anchor" href="#backup-commands" aria-label="Permalink to &quot;Backup Commands&quot;">​</a></h2><h3 id="postgresql-backup" tabindex="-1">PostgreSQL Backup <a class="header-anchor" href="#postgresql-backup" aria-label="Permalink to &quot;PostgreSQL Backup&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Using pg_dump</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y%m%d_%H%M%S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or with Docker</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exec</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver-postgres</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup_</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y%m%d_%H%M%S</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.sql</span></span></code></pre></div><h3 id="storage-folder-backup" tabindex="-1">Storage Folder Backup <a class="header-anchor" href="#storage-folder-backup" aria-label="Permalink to &quot;Storage Folder Backup&quot;">​</a></h3><p><strong>Local to cloud (using rclone):</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Configure rclone for your cloud provider first</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rclone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/storage/open-archiver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote:bucket/open-archiver-backup</span></span></code></pre></div><p><strong>Local to local:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -av</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/storage/open-archiver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /backup/location/</span></span></code></pre></div><p><strong>If using S3 storage:</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Enable versioning on your S3 bucket for point-in-time recovery</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aws</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s3api</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> put-bucket-versioning</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --bucket</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your-bucket</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --versioning-configuration</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Status=Enabled</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or sync to another bucket</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">aws</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sync</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s3://source-bucket/open-archiver</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> s3://backup-bucket/open-archiver</span></span></code></pre></div><h3 id="meilisearch-backup-optional" tabindex="-1">Meilisearch Backup (Optional) <a class="header-anchor" href="#meilisearch-backup-optional" aria-label="Permalink to &quot;Meilisearch Backup (Optional)&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Create a dump via API</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -X</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> POST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://localhost:7700/dumps&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -H</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Authorization: Bearer YOUR_API_KEY&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or copy the data directory</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/meilisearch/data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /backup/location/meilisearch</span></span></code></pre></div><h2 id="automated-backup-script" tabindex="-1">Automated Backup Script <a class="header-anchor" href="#automated-backup-script" aria-label="Permalink to &quot;Automated Backup Script&quot;">​</a></h2><p>Here&#39;s an example script for automated backups:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BACKUP_DIR</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/backup/openarchiver/$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%Y%m%d)&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">STORAGE_PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/path/to/storage&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DB_HOST</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DB_USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openarchiver&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DB_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openarchiver&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$BACKUP_DIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Backing up PostgreSQL...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pg_dump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_HOST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_USER</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$DB_NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> gzip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$BACKUP_DIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/database.sql.gz&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Backing up storage folder...&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -av</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$STORAGE_PATH</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/open-archiver/&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$BACKUP_DIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/storage/&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Backup complete: </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$BACKUP_DIR</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional: Upload to cloud</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># rclone sync &quot;$BACKUP_DIR&quot; remote:openarchiver-backups/$(date +%Y%m%d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Optional: Remove backups older than 30 days</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># find /backup/openarchiver -type d -mtime +30 -exec rm -rf {} +</span></span></code></pre></div><h2 id="restore-procedure" tabindex="-1">Restore Procedure <a class="header-anchor" href="#restore-procedure" aria-label="Permalink to &quot;Restore Procedure&quot;">​</a></h2><h3 id="_1-restore-postgresql" tabindex="-1">1. Restore PostgreSQL <a class="header-anchor" href="#_1-restore-postgresql" aria-label="Permalink to &quot;1. Restore PostgreSQL&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Drop and recreate database (if needed)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;DROP DATABASE IF EXISTS openarchiver;&quot;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> postgres</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CREATE DATABASE openarchiver OWNER openarchiver;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Restore from backup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup.sql</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Or with gzipped backup</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gunzip</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup.sql.gz</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -U</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> openarchiver</span></span></code></pre></div><h3 id="_2-restore-storage-folder" tabindex="-1">2. Restore Storage Folder <a class="header-anchor" href="#_2-restore-storage-folder" aria-label="Permalink to &quot;2. Restore Storage Folder&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rsync</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -av</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /backup/location/open-archiver/</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /path/to/storage/open-archiver/</span></span></code></pre></div><h3 id="_3-rebuild-meilisearch-index-if-not-backed-up" tabindex="-1">3. Rebuild Meilisearch Index (if not backed up) <a class="header-anchor" href="#_3-rebuild-meilisearch-index-if-not-backed-up" aria-label="Permalink to &quot;3. Rebuild Meilisearch Index (if not backed up)&quot;">​</a></h3><p>After restoring the database and storage, restart Open Archiver. The search index will need to be rebuilt:</p><ol><li>Go to <strong>Admin &gt; Jobs</strong> in the dashboard</li><li>Or trigger re-indexing via API (enterprise feature)</li></ol><h2 id="backup-best-practices" tabindex="-1">Backup Best Practices <a class="header-anchor" href="#backup-best-practices" aria-label="Permalink to &quot;Backup Best Practices&quot;">​</a></h2><ol><li><strong>Test your backups</strong> - Periodically restore to a test environment</li><li><strong>Use encryption</strong> - Encrypt backups at rest, especially if storing in the cloud</li><li><strong>Follow 3-2-1 rule</strong> - 3 copies, 2 different media types, 1 offsite</li><li><strong>Automate</strong> - Use cron jobs or scheduled tasks for regular backups</li><li><strong>Monitor</strong> - Set up alerts for backup failures</li><li><strong>Document</strong> - Keep restore procedures documented and accessible</li></ol><h2 id="backup-frequency-recommendations" tabindex="-1">Backup Frequency Recommendations <a class="header-anchor" href="#backup-frequency-recommendations" aria-label="Permalink to &quot;Backup Frequency Recommendations&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Data</th><th>Frequency</th><th>Retention</th></tr></thead><tbody><tr><td>PostgreSQL</td><td>Daily</td><td>30 days</td></tr><tr><td>Storage folder</td><td>Daily (incremental)</td><td>Keep all</td></tr><tr><td>Meilisearch</td><td>Weekly (optional)</td><td>2 versions</td></tr></tbody></table><p>For high-volume environments, consider more frequent database backups or continuous replication.</p>`,44)]))}const g=a(n,[["render",l]]);export{c as __pageData,g as default};
